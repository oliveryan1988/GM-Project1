@using LincolnBrandChampion.Model.Models
@model List<ProfileModel>
@{
    Layout = null;
    Response.ContentType = "application/vnd.ms-excel";
    Response.AddHeader("Content-Disposition", "attachment; filename=ReportTickets.xls");
}

<?xml version="1.0" encoding="utf-16" ?>
<ss:Workbook xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet">
    <ss:Worksheet ss:Name="Sheet1">
        <ss:Table>
            <ss:Row>
                <ss:Cell ecProperty="">
                    <ss:Data ss:Type="String">P&A Code</ss:Data>
                </ss:Cell>
                <ss:Cell ecProperty="">
                    <ss:Data ss:Type="String">First Name</ss:Data>
                </ss:Cell>
                <ss:Cell ecProperty="">
                    <ss:Data ss:Type="String">Last Name</ss:Data>
                </ss:Cell>
                <ss:Cell ecProperty="">
                    <ss:Data ss:Type="String">Email Address</ss:Data>
                </ss:Cell>
                <ss:Cell ecProperty="">
                    <ss:Data ss:Type="String">Dealer Type</ss:Data>
                </ss:Cell>
                <ss:Cell ecProperty="">
                    <ss:Data ss:Type="String">Dealership Name</ss:Data>
                </ss:Cell>
                <ss:Cell ecProperty="">
                    <ss:Data ss:Type="String">Market</ss:Data>
                </ss:Cell>                                
                <ss:Cell ecProperty="">
                    <ss:Data ss:Type="String">Zone</ss:Data>
                </ss:Cell>
                                <ss:Cell ecProperty="">
                    <ss:Data ss:Type="String">Sales Code</ss:Data>
                </ss:Cell>
                                <ss:Cell ecProperty="">
                    <ss:Data ss:Type="String">Department Info</ss:Data>
                </ss:Cell>
                                <ss:Cell ecProperty="">
                    <ss:Data ss:Type="String">Attended Immersion</ss:Data>
                </ss:Cell>
                      <ss:Cell ecProperty="">
                    <ss:Data ss:Type="String">Attended Summit</ss:Data>
                </ss:Cell>
                <ss:Cell ecProperty="">
                    <ss:Data ss:Type="String">Checkpoint 1</ss:Data>
                </ss:Cell>
                <ss:Cell ecProperty="">
                    <ss:Data ss:Type="String">Checkpoint 2</ss:Data>
                </ss:Cell>
                <ss:Cell ecProperty="">
                    <ss:Data ss:Type="String">Checkpoint 3</ss:Data>
                </ss:Cell>
                <ss:Cell ecProperty="">
                    <ss:Data ss:Type="String">Member of Facebook Group</ss:Data>
                </ss:Cell>
            </ss:Row>
            @foreach (var item in Model)
            {
                <ss:Row>
                    <ss:Cell>
                        <ss:Data ss:Type="String">@item.PA_CODE
                        </ss:Data>
                    </ss:Cell>
                    <ss:Cell>
                        <ss:Data ss:Type="String">@item.FIRST_NAME
                        </ss:Data>
                    </ss:Cell>
                    <ss:Cell>
                        <ss:Data ss:Type="String">@item.LAST_NAME
                        </ss:Data>
                    </ss:Cell>
                    <ss:Cell>
                        <ss:Data ss:Type="String">@item.EMAIL_ID
                        </ss:Data>
                    </ss:Cell>
                    <ss:Cell>
                       <ss:Data ss:Type="String">@item.DEALER_TYPE
                        </ss:Data>
                    </ss:Cell>
                    <ss:Cell>
                       <ss:Data ss:Type="String">@item.DLR_NAME
                        </ss:Data>
                    </ss:Cell>
                    <ss:Cell>
                       <ss:Data ss:Type="String">@item.DLR_REGION
                        </ss:Data>
                    </ss:Cell>
                    <ss:Cell>
                       <ss:Data ss:Type="String">@item.ZONE
                        </ss:Data>
                    </ss:Cell>
                                        <ss:Cell>
                       <ss:Data ss:Type="String">@item.SALESCODE
                        </ss:Data>
                    </ss:Cell>
                                        <ss:Cell>
                       <ss:Data ss:Type="String">@item.DEPT_INFO
                        </ss:Data>
                    </ss:Cell>

               
                @foreach (RecognitionModel itemRecognition in item.recognitionList)
                {
                    <ss:Cell>
                        <ss:Data ss:Type="String">@if (@itemRecognition.STATUS == "Y") 
                               { @Html.Raw("Completed"); } 
                               else 
                               { @Html.Raw("Not Completed"); }
                        </ss:Data>
                    </ss:Cell>
                
                }
                </ss:Row>
            }
        </ss:Table>
    </ss:Worksheet>
</ss:Workbook>
